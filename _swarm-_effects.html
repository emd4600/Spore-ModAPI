<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Swarm: The effects system | Spore ModAPI SDK for creating C++ mods for Spore</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark.css" />
  <link rel="stylesheet" href="m-documentation.css" />
  <link rel="icon" href="Spore_ModAPI_Icon.png" type="image/png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m"><img src="Spore_ModAPI_Icon.png" />Spore ModAPI <span class="m-thin">SDK for creating C++ mods for Spore</span></a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Tutorials</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Swarm: The effects system
        </h1>
        <p>How to spawn effects.</p>
<p>For effects such as particles, decals, etc Spore uses a custom engine called Swarm. Everything related to effects is in the <a href="namespace_swarm.html" class="m-doc">Swarm</a> namespace.</p><p>Effects are a collection of components with different attributes, e.g. spawn 10 red particles here, move a model in this direction,... You can create your own effects (or discover how existing ones are made) with SporeModderFX, more information here: <a href="https://github.com/emd4600/SporeModder-FX/wiki">https:/<wbr />/<wbr />github.com/<wbr />emd4600/<wbr />SporeModder-FX/<wbr />wiki</a></p><p>Effects are uniquely identified with an ID. But keep in mind that this ID is only used to identify the structure of the effect itself: you can have multiple instances of the same effect at the same time.</p><section id="Swarm-Effects-Spawning"><h2><a href="#Swarm-Effects-Spawning">Spawning effects</a></h2><p>The basic operation that can be done with Swarm is spawning an instance of an effect, and that is done with the <a href="class_swarm_1_1_i_swarm_manager.html" class="m-doc">SwarmManager</a>. First you have to declare an intrusive pointer to the <a href="class_swarm_1_1_i_effect.html" class="m-doc">Swarm::<wbr />IEffect</a> class, which is where the effect will be stored. Then you call the <code>CreateEffect()</code> method with the ID of the effect. This method returns <code>true</code> if the effect was sucessfully created; it&#x27;s good practice to check it before doing anything with it to avoid crashes:</p><pre class="m-code"><span class="n">IEffectPtr</span><span class="w"> </span><span class="n">effect</span><span class="p">;</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SwarmManager</span><span class="p">.</span><span class="n">CreateEffect</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="s">&quot;SG_ufo_scan_HitGround&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">effect</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// This will only be executed if the effect existed and a new instance was created</span>
<span class="p">}</span><span class="w"></span></pre><p>Now, with just this the effect will not show yet. You have to call <code>Start()</code> to make it show; similarly, you can kill it anytime by calling <code>Stop()</code>.</p><pre class="m-code"><span class="n">IEffectPtr</span><span class="w"> </span><span class="n">effect</span><span class="p">;</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SwarmManager</span><span class="p">.</span><span class="n">CreateEffect</span><span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="s">&quot;SG_ufo_scan_HitGround&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">effect</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">effect</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span></pre></section><section id="Swarm-Effects-Transform"><h2><a href="#Swarm-Effects-Transform">Transforming the effects</a></h2><p>With what you learned before, the effects will always spawn at the same position. Obviously, this is not what we want. The effect class has a method called <code><a href="namespace_graphics_1_1_global_state.html#ac6b20b8cd1bfdfa021ac22a8eb2e400b" class="m-doc">SetTransform()</a></code> that allows us to move, scale and rotate the effect. This takes a <a href="class_transform.html" class="m-doc">Transform</a> object; for more information on how it works, check the <a href="_math.html">math tutorial</a>.</p><pre class="m-code"><span class="c1">// This set the scale of the effect to 0.5 (so it will be half the original size)</span>
<span class="c1">// and moves it one unit up. As you can see, transformations can be concatenated</span>
<span class="n">effect</span><span class="o">-&gt;</span><span class="n">SetTransform</span><span class="p">(</span><span class="n">Transform</span><span class="p">().</span><span class="n">SetScale</span><span class="p">(</span><span class="mf">0.5f</span><span class="p">).</span><span class="n">SetOffset</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">));</span><span class="w"></span></pre><p>Another important property of effects is the <strong>seed</strong>. A seed is a special number used to generate random numbers. Many effects, in order to look variated, often depend on random numbers to make multiple instances of the same effect look different. By fixing a seed, you will always make it look the same.</p><pre class="m-code"><span class="c1">// Seed is just an integer number</span>
<span class="n">effect</span><span class="o">-&gt;</span><span class="n">SetSeed</span><span class="p">(</span><span class="mi">8721947</span><span class="p">);</span><span class="w"></span></pre></section><section id="Swarm-Effects-Examples"><h2><a href="#Swarm-Effects-Examples">Examples</a></h2><section id="Swarm-Effects-Examples-1"><h3><a href="#Swarm-Effects-Examples-1">Example 1: Spawning effects at random positions</a></h3><p>In this example we will spawn multiple instances of <code>SG_gasGiant_01~</code> (which corresponds to ID <code>0x03F54A4F</code>). Actually, we will make it more interesting: there are 12 different gas giant effects, and their IDs can be accessed by just adding to that first ID. We will create one instance of each gas giant and place it in a random position (in a radius of 7 units) using <a href="namespace_math.html#aa9802e9f7360669e47bffdb8531261e3" class="m-doc">Math::<wbr />randf()</a></p><pre class="m-code"><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">12</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">IEffectPtr</span><span class="w"> </span><span class="n">effect</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">SwarmManager</span><span class="p">.</span><span class="n">CreateEffect</span><span class="p">(</span><span class="mh">0x03F54A4F</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">effect</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// X and Y can go negative, but we will only use positive Z so it doesn&#39;t go below the ground</span>
<span class="w">        </span><span class="n">effect</span><span class="o">-&gt;</span><span class="n">SetTransform</span><span class="p">(</span><span class="n">Transform</span><span class="p">()</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">SetOffset</span><span class="p">(</span><span class="n">Math</span><span class="o">::</span><span class="n">randf</span><span class="p">(</span><span class="mi">-7</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="n">Math</span><span class="o">::</span><span class="n">randf</span><span class="p">(</span><span class="mi">-7</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="n">Math</span><span class="o">::</span><span class="n">randf</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="p">.</span><span class="n">SetScale</span><span class="p">(</span><span class="mf">0.08f</span><span class="p">));</span><span class="w"></span>
<span class="w">        </span><span class="n">effect</span><span class="o">-&gt;</span><span class="n">Start</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span></pre><p>Try putting this code inside a custom cheat and execute it in the creature editor. This will be the result:</p><img class="m-image" src="effects_example_1.png" alt="Image" /><p>You can download the <a href="effects_example_1.cpp"><code>dllmain.cpp</code> source code here</a>.</p></section></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Spore ModAPI SDK for creating C++ mods for Spore. Created with <a href="https://doxygen.org/">Doxygen</a> 1.8.16 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
